[![.NET](https://github.com/JWMB/AzureMonitorCommonAlertSchemaTypes/actions/workflows/dotnet.yml/badge.svg)](https://github.com/JWMB/AzureMonitorCommonAlertSchemaTypes/actions/workflows/dotnet.yml)

# AzureMonitorCommonAlertSchemaTypes
Library with types and serializing utils for azureMonitorCommonAlertSchema

*Work in progress*

No type information seems to be provided by Microsoft for handling alert payloads - no JSON Schema and no .NET type library. This library is built on guesswork based on various example payloads.

Also overall design principles seem lacking. Sometimes properties are camelCase, sometimes PascalCase. Compare ServiceHealthAlertContext with ResourceHealthAlertContext - some properties sound like they should be shared, but the types differ.
Please get back to the drawing board!

See [ActionGroupTests](/Tests/Json/ActionGroupTests) for the payloads generated by [Azure ActionGroup tester](https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/action-groups#test-an-action-group-in-the-azure-portal-preview) 

The respective unit tests can be found in [ActionGroupTests.cs](/Tests/ActionGroupTests.cs)

Example usage in [AzureAlerts2Slack](https://github.com/JWMB/AzureAlerts2Slack/blob/main/AlertInfo.cs)
or
```C#
var alert = Types.AlertJsonSerializerSettings.DeserializeOrThrow(requestBody);
if (ctx is Types.AlertContexts.LogAnalyticsAlertContext ctxLogAnalytics)
{
    Console.Log($"{alert.Data.Essentials.AlertRule} - tables:{string.Join(", ", ctxLogAnalytics.SearchResults.Tables.Select(o => o.Name))}");
}
```

Uses [SlackNet](https://github.com/soxtoby/SlackNet) for Slack Message payload types.

Related 3rd-party repos
* [Azure-Monitor-Alerts-To-MsTeams](https://github.com/Brink-Software/Azure-Monitor-Alerts-To-MsTeams)
* [Common-Alert-Schema](https://github.com/scautomation/Common-Alert-Schema)

